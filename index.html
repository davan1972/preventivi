<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preventivatore Montascale</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1a4d2e;
            --primary-light: #2d6a4f;
            --accent: #d4af37;
            --bg: #faf8f3;
            --surface: #ffffff;
            --text: #2b2b2b;
            --text-light: #6b6b6b;
            --border: #e5e0d5;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        header {
            text-align: center;
            margin-bottom: 60px;
            position: relative;
        }

        h1 {
            font-family: 'DM Serif Display', serif;
            font-size: 3.5rem;
            color: var(--primary);
            margin-bottom: 12px;
            letter-spacing: -0.02em;
        }

        .subtitle {
            font-size: 1.1rem;
            color: var(--text-light);
            font-weight: 300;
        }

        .decorative-line {
            width: 80px;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
            margin: 30px auto;
        }

        .form-card {
            background: var(--surface);
            border-radius: 20px;
            padding: 45px;
            box-shadow: 0 4px 24px rgba(26, 77, 46, 0.08);
            border: 1px solid var(--border);
            margin-bottom: 30px;
        }

        .form-section {
            margin-bottom: 40px;
            opacity: 0;
            animation: fadeInUp 0.6s ease forwards;
        }

        .form-section:nth-child(1) { animation-delay: 0.1s; }
        .form-section:nth-child(2) { animation-delay: 0.2s; }
        .form-section:nth-child(3) { animation-delay: 0.3s; }
        .form-section:nth-child(4) { animation-delay: 0.4s; }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-title {
            font-family: 'DM Serif Display', serif;
            font-size: 1.6rem;
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-number {
            background: var(--accent);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-family: 'Outfit', sans-serif;
            font-weight: 600;
        }

        .radio-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .radio-option {
            position: relative;
        }

        .radio-option input[type="radio"] {
            position: absolute;
            opacity: 0;
        }

        .radio-option label {
            display: block;
            padding: 18px 22px;
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .radio-option input[type="radio"]:checked + label {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(26, 77, 46, 0.2);
        }

        .radio-option label:hover {
            border-color: var(--primary-light);
        }

        .checkbox-group {
            margin-top: 15px;
        }

        .checkbox-option {
            margin-bottom: 12px;
            display: block;
        }

        .checkbox-option input[type="checkbox"] {
            display: none;
        }

        .checkbox-option label {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 18px;
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkbox-option input[type="checkbox"]:checked + label {
            background: var(--primary-light);
            color: white;
            border-color: var(--primary-light);
        }

        .checkbox-option label:hover {
            border-color: var(--primary-light);
        }

        .checkbox-icon {
            width: 20px;
            height: 20px;
            border: 2px solid currentColor;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .checkbox-option input[type="checkbox"]:checked + label .checkbox-icon::after {
            content: '✓';
            color: white;
            font-weight: bold;
        }

        .input-group {
            margin-top: 15px;
        }

        .input-wrapper {
            margin-bottom: 20px;
        }

        .input-wrapper label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
        }

        .input-wrapper input,
        .input-wrapper textarea {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-family: 'Outfit', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .input-wrapper input:focus,
        .input-wrapper textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26, 77, 46, 0.1);
        }

        .input-wrapper textarea {
            resize: vertical;
            min-height: 100px;
        }

        .input-hint {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-top: 6px;
        }

        .option-category {
            margin-bottom: 30px;
            padding: 25px;
            background: var(--bg);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .category-title {
            font-family: 'DM Serif Display', serif;
            font-size: 1.2rem;
            color: var(--primary-light);
            margin-bottom: 18px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent);
        }

        .btn-submit {
            background: var(--primary);
            color: white;
            padding: 18px 48px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Outfit', sans-serif;
            width: 100%;
            margin-top: 20px;
        }

        .btn-submit:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(26, 77, 46, 0.25);
        }

        .btn-submit:active {
            transform: translateY(0);
        }

        #risultato {
            margin-top: 40px;
            padding: 30px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            border-radius: 16px;
            display: none;
        }

        #risultato h2 {
            font-family: 'DM Serif Display', serif;
            font-size: 2rem;
            margin-bottom: 20px;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 3px solid rgba(26, 77, 46, 0.1);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none;
        }

        .price-summary {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border: 3px solid var(--accent);
            border-radius: 16px;
            padding: 35px;
            margin-top: 20px;
        }

        .price-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 0;
            border-bottom: 2px solid var(--border);
        }

        .price-row:last-child {
            border-bottom: none;
        }

        .price-block {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 6px;
        }

        .price-label {
            font-size: 1.3rem;
            font-weight: 500;
            color: var(--text);
        }

        .price-value {
            font-family: 'DM Serif Display', serif;
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }

        .price-iva {
            font-size: 0.95rem;
            color: var(--text-light);
            font-weight: 400;
        }

        .price-final {
            margin-top: 10px;
            padding-top: 25px;
            border-top: 3px solid var(--accent) !important;
        }

        .price-final .price-label {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
        }

        .price-final .price-value {
            font-size: 2.8rem;
            color: var(--primary);
            text-shadow: 0 2px 4px rgba(26, 77, 46, 0.1);
        }

        .discount-input-wrapper {
            margin: 25px 0;
            padding: 25px;
            background: white;
            border-radius: 12px;
            border: 2px solid var(--accent);
        }

        .discount-input-wrapper label {
            display: block;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 12px;
        }

        .discount-input-wrapper input {
            width: 100%;
            padding: 18px 24px;
            font-size: 1.8rem;
            font-weight: 600;
            text-align: center;
            border: 3px solid var(--border);
            border-radius: 12px;
            font-family: 'Outfit', sans-serif;
            background: var(--bg);
            color: var(--primary);
            transition: all 0.3s ease;
        }

        .discount-input-wrapper input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 4px rgba(212, 175, 55, 0.2);
            background: white;
        }

        .discount-input-wrapper input::placeholder {
            color: var(--text-light);
            opacity: 0.5;
        }

        footer {
            text-align: center;
            margin-top: 60px;
            padding-top: 40px;
            border-top: 1px solid var(--border);
            color: var(--text-light);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }

            .form-card {
                padding: 30px 20px;
            }

            .radio-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Preventivatore</h1>
            <p class="subtitle">Sistema professionale per montascale</p>
            <div class="decorative-line"></div>
        </header>

        <form id="preventivoForm" class="form-card">
            <!-- Sezione 1: Tipo Prodotto -->
            <div class="form-section">
                <h2 class="section-title">
                    <span class="section-number">1</span>
                    Tipo di Prodotto
                </h2>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="poltroncina" name="tipo" value="poltroncina" required>
                        <label for="poltroncina">Montascale a Poltroncina</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="pedana" name="tipo" value="pedana">
                        <label for="pedana">Montascale a Pedana</label>
                    </div>
                </div>
            </div>

            <!-- Sezione 2: Modello -->
            <div class="form-section">
                <h2 class="section-title">
                    <span class="section-number">2</span>
                    Modello
                </h2>
                
                <!-- Modelli Poltroncina -->
                <div id="modelliPoltroncina" class="radio-group hidden">
                    <div class="radio-option">
                        <input type="radio" name="modello" value="Facile Sprint 1100" id="sprint">
                        <label for="sprint">Facile Sprint 1100</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="modello" value="Facile Elegance 1000" id="elegance">
                        <label for="elegance">Facile Elegance 1000</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="modello" value="Facile Superior H4000" id="superior">
                        <label for="superior">Facile Superior H4000</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="modello" value="Facile Graziosa Freecurve" id="graziosa">
                        <label for="graziosa">Facile Graziosa Freecurve</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="modello" value="Infinity Curvilineo Bespoke" id="infinity">
                        <label for="infinity">Infinity Curvilineo Bespoke</label>
                    </div>
                </div>

                <!-- Modelli Pedana -->
                <div id="modelliPedana" class="radio-group hidden">
                    <div class="radio-option">
                        <input type="radio" name="modello" value="Facile Step SRC" id="src">
                        <label for="src">Facile Step SRC (rettilineo)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="modello" value="Facile Step SSC" id="ssc">
                        <label for="ssc">Facile Step SSC (curvilineo)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="modello" value="Facile Step X3" id="x3">
                        <label for="x3">Facile Step X3 (rettilineo)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="modello" value="Facile Step ARTIRA" id="artira">
                        <label for="artira">Facile Step ARTIRA</label>
                    </div>
                </div>
            </div>

            <!-- Sezione 3: Configurazione -->
            <div class="form-section">
                <h2 class="section-title">
                    <span class="section-number">3</span>
                    Configurazione e Opzioni
                </h2>

                <div id="opzioniContainer"></div>
            </div>

            <!-- Sezione 4: Riepilogo Prezzi -->
            <div class="form-section">
                <h2 class="section-title">
                    <span class="section-number">4</span>
                    Riepilogo Prezzi
                </h2>

                <div class="price-summary">
                    <div class="price-row">
                        <span class="price-label">Prezzo di Listino:</span>
                        <div class="price-block">
                            <span class="price-value" id="prezzoListino">€ 0,00</span>
                            <span class="price-iva" id="prezzoListinoIva">(IVA incl. € 0,00)</span>
                        </div>
                    </div>

                    <div class="discount-input-wrapper">
                        <label for="sconto">Sconto Applicato (%)</label>
                        <input type="number" 
                               id="sconto" 
                               name="sconto" 
                               min="0" 
                               max="100" 
                               step="0.5" 
                               value="0"
                               placeholder="0">
                    </div>

                    <div class="price-row price-final">
                        <span class="price-label">Prezzo Finale:</span>
                        <div class="price-block">
                            <span class="price-value" id="prezzoFinale">€ 0,00</span>
                            <span class="price-iva" id="prezzoFinaleIva">(IVA incl. € 0,00)</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sezione 5: Dati Cliente -->
            <div class="form-section">
                <h2 class="section-title">
                    <span class="section-number">5</span>
                    Dati Cliente
                </h2>

                <div class="input-group">
                    <div class="input-wrapper">
                        <label>Nome e Cognome *</label>
                        <input type="text" name="cliente_nome" required placeholder="Mario Rossi">
                    </div>

                    <div class="input-wrapper">
                        <label>Email</label>
                        <input type="email" name="cliente_email" placeholder="mario.rossi@email.it">
                    </div>

                    <div class="input-wrapper">
                        <label>Telefono</label>
                        <input type="tel" name="cliente_telefono" placeholder="+39 333 1234567">
                    </div>

                    <div class="input-wrapper">
                        <label>Indirizzo installazione</label>
                        <input type="text" name="indirizzo" placeholder="Via Roma 123, Milano">
                    </div>

                    <div class="input-wrapper">
                        <label>Note aggiuntive</label>
                        <textarea name="note" placeholder="Eventuali richieste particolari o dettagli importanti..."></textarea>
                    </div>
                </div>
            </div>

            <button type="submit" class="btn-submit">Genera Preventivo</button>
        </form>

        <div id="risultato"></div>

        <footer>
            <p>Sistema di preventivazione automatica • Facile Salire 2026</p>
        </footer>
    </div>

    <script>
        // Configurazione n8n webhook
        const N8N_WEBHOOK_URL = 'https://TUO_N8N_URL.app.n8n.cloud/webhook/preventivo-montascale';

        // Mappa prezzi per modello (estratti da Excel)
        const prezziModelli = {
            'Facile Sprint 1100': {
                base: 4508.00,
                opt_estensione_guida: 429.80,
                opt_guida_tagliata: 100.80,
                opt_guida_ribaltabile: 553.00,
                opt_tappeti: 82.60,
                opt_guida_scorrevole_47: 1349.60,
                opt_guida_scorrevole_705: 1776.60,
                opt_zero_intrusion_47: 288.40,
                opt_zero_intrusion_705: 373.80,
                opt_rotazione_auto: 1054.20,
                opt_pedana_motor: 1036.00,
                opt_motor_completo: 1573.60,
                opt_one_touch: 603.20
            },
            'Facile Elegance 1000': {
                base: 5150.00,
                opt_estensione_guida: 335.40,
                opt_guida_tagliata: 97.50,
                opt_guida_ribaltabile: 770.90,
                opt_tappeti: 54.60,
                opt_guida_ribaltabile_motor: 1110.20,
                opt_versione_esterni: 579.80,
                opt_sedile_perch: 232.70,
                opt_distanziale_singolo: 104.00,
                opt_distanziale_doppio: 157.30,
                opt_cintura_velcro: 124.80,
                opt_body_harness: 596.70,
                opt_heavy_duty_xl: 380.90,
                opt_heavy_duty_xxl: 1648.40,
                opt_rotazione_auto: 512.20,
                opt_rotazione_2dir: 683.80,
                opt_pedana_motor: 495.30,
                opt_motor_completo: 1006.20,
                opt_motor_completo_2dir: 1177.80,
                opt_one_touch: 603.20,
                opt_smontaggio: 300.00
            },
            'Facile Superior H4000': {
                base: 5985.20,
                metri_guida: 308.75, // per metro
                opt_sedile_perch: 546.00,
                opt_sedile_esterni: 286.00,
                opt_sedile_style: 286.00,
                opt_bracciolo_corto: 130.00,
                opt_distanziale_singolo: 101.40,
                opt_distanziale_doppio: 156.00,
                opt_cintura_velcro: 123.50,
                opt_body_harness: 592.80,
                curve_90_qty: 673.40, // per curva
                punti_ricarica_qty: 127.40, // per punto
                metri_esterni: 45.50, // per metro
                fermate_intermedie_qty: 127.40, // per fermata
                opt_overrun: 358.80,
                opt_dropnose: 371.80,
                opt_guida_ribaltabile_motor: 1638.00,
                opt_heavy_duty_160: 897.00,
                opt_tappeti: 54.60,
                opt_colore_speciale: 1150.50,
                opt_versione_esterni: 1524.90,
                opt_piastre_muro: 80.60,
                opt_conversion_kit: 66.30,
                opt_rotazione_auto: 496.60,
                opt_pedana_motor: 496.60,
                opt_motor_completo: 980.20,
                radiocomandi_qty: 113.10, // per radiocomando
                opt_one_touch: 603.20
            },
            'Facile Graziosa Freecurve': {
                base: 7501.80,
                metri_guida: 436.80, // per metro
                curve_90_qty: 741.00, // per curva
                punti_ricarica_qty: 140.40, // per punto
                attacchi_muro_qty: 88.40, // per attacco
                radiocomandi_qty: 124.80, // per radiocomando
                opt_elegance_seat: 315.60,
                opt_alliance_seat: 491.40,
                opt_active_seat: 648.70,
                opt_body_harness_4p: 648.70,
                opt_guida_ribaltabile_motor: 1803.90,
                opt_colore_speciale: 1267.50,
                opt_solo_guida: 2119.50,
                opt_rotazione_auto: 546.00,
                opt_rotazione_2dir: 720.20,
                opt_pedana_illuminato: 546.00,
                opt_batteria_extra: 140.40,
                opt_batteria_ultra: 218.40,
                opt_kit_ripetitore: 234.00
            },
            'Infinity Curvilineo Bespoke': {
                base: 7150.00,
                metri_guida: 280.80, // per metro
                metri_guida_hd: 312.00, // per metro HD
                curve_90_qty: 468.00, // per curva
                curve_180_qty: 624.00, // per curva
                curve_speciali_qty: 624.00, // per curva
                fermate_intermedie_qty: 156.00, // per fermata
                punti_ricarica_qty: 124.80, // per punto
                telecomandi_qty: 93.60, // per telecomando
                opt_motor_hd: 1092.00,
                opt_seduta_regolabile: 218.40,
                opt_sedile_motor: 405.60,
                opt_dual_control: 218.40,
                opt_partenza_drop: 249.60,
                opt_arrivo_orizzontale: 249.60,
                opt_fissaggio_muro: 93.60,
                opt_coprigambe: 93.60,
                opt_colore_nero: 468.00,
                opt_colore_marrone: 468.00
            },
            'Facile Step SRC': {
                base: 8287.50,
                alzate: 75.00, // per alzata
                metri_guida_extra: 225.00, // per metro
                colonnini_qty: 120.00, // per colonnino
                fermate_intermedie_qty: 450.00, // per fermata
                opt_ped_esterni: 30.00, // supplemento per alzata + 90 per metro
                opt_ped_acustico: 225.00
            },
            'Facile Step SSC': {
                base: 10062.00,
                alzate: 78.00, // per alzata
                metri_guida_extra: 234.00, // per metro
                curve_90_qty: 702.00, // per curva
                curve_180_qty: 904.80, // per curva
                colonnini_qty: 124.80, // per colonnino
                fermate_intermedie_qty: 468.00, // per fermata
                opt_ped_esterni: 31.20, // supplemento per alzata + 93.60 per metro
                opt_ped_acustico: 234.00,
                opt_curve_zincate: 78.00 // per curva
            },
            'Facile Step X3': {
                base: 9245.60,
                alzate: 0, // incluso in base
                metri_guida_extra: 0,
                opt_piattaforma_640: 845.00,
                opt_piattaforma_800: 0,
                opt_piattaforma_1050: 469.30,
                opt_ped_esterni: 0
            },
            'Facile Step ARTIRA': {
                base: 12000.00, // valore stimato
                alzate: 85.00,
                metri_guida_extra: 250.00
            }
        };

        // Funzione calcolo totale
        function calcolaTotale() {
            const modelloSelezionato = document.querySelector('input[name="modello"]:checked');
            if (!modelloSelezionato) {
                document.getElementById('prezzoListino').textContent = '€ 0,00';
                document.getElementById('prezzoListinoIva').textContent = '(IVA incl. € 0,00)';
                document.getElementById('prezzoFinale').textContent = '€ 0,00';
                document.getElementById('prezzoFinaleIva').textContent = '(IVA incl. € 0,00)';
                return;
            }

            const modello = modelloSelezionato.value;
            const prezzi = prezziModelli[modello];
            if (!prezzi) return;

            let totale = prezzi.base || 0;

            // Aggiungi opzioni checkbox
            document.querySelectorAll('#opzioniContainer input[type="checkbox"]:checked').forEach(checkbox => {
                const optId = checkbox.id;
                if (prezzi[optId]) {
                    totale += prezzi[optId];
                }
            });

            // Aggiungi input numerici (quantità)
            document.querySelectorAll('#opzioniContainer input[type="number"]').forEach(input => {
                const optId = input.name;
                const qty = parseFloat(input.value) || 0;
                if (qty > 0 && prezzi[optId]) {
                    totale += prezzi[optId] * qty;
                }
            });

            // Calcola IVA 4%
            const totaleIva = totale * 1.04;

            // Mostra prezzo listino
            document.getElementById('prezzoListino').textContent = 
                '€ ' + totale.toLocaleString('it-IT', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            document.getElementById('prezzoListinoIva').textContent = 
                '(IVA incl. € ' + totaleIva.toLocaleString('it-IT', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ')';

            // Calcola sconto
            const sconto = parseFloat(document.getElementById('sconto').value) || 0;
            const prezzoFinale = totale * (1 - sconto / 100);
            const prezzoFinaleIva = prezzoFinale * 1.04;

            document.getElementById('prezzoFinale').textContent = 
                '€ ' + prezzoFinale.toLocaleString('it-IT', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            document.getElementById('prezzoFinaleIva').textContent = 
                '(IVA incl. € ' + prezzoFinaleIva.toLocaleString('it-IT', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ')';
        }

        // Mappa opzioni per modello (basata su analisi Excel)
        const opzioniPerModello = {
            'Facile Sprint 1100': [
                { id: 'opt_estensione_guida', label: 'Estensione guida di 2.35 mt', categoria: 'guida' },
                { id: 'opt_guida_tagliata', label: 'Guida tagliata a misura', categoria: 'guida' },
                { id: 'opt_guida_ribaltabile', label: 'Guida ribaltabile manuale', categoria: 'guida' },
                { id: 'opt_tappeti', label: 'Tappeti', categoria: 'guida' },
                { id: 'opt_guida_scorrevole_47', label: 'Guida scorrevole 4.7 m', categoria: 'guida' },
                { id: 'opt_guida_scorrevole_705', label: 'Guida scorrevole 7.05 m', categoria: 'guida' },
                { id: 'opt_zero_intrusion_47', label: 'Kit zero intrusion 4.7 m', categoria: 'guida' },
                { id: 'opt_zero_intrusion_705', label: 'Kit zero intrusion 7.05 m', categoria: 'guida' },
                { id: 'opt_rotazione_auto', label: 'Rotazione seggiolino automatica', categoria: 'motorizzate' },
                { id: 'opt_pedana_motor', label: 'Poggiapiedi motorizzato', categoria: 'motorizzate' },
                { id: 'opt_motor_completo', label: 'Motorizzato completo (sedile e pedana)', categoria: 'motorizzate' },
                { id: 'opt_one_touch', label: 'One Touch Alert (SIM non inclusa)', categoria: 'motorizzate' }
            ],
            'Facile Elegance 1000': [
                { id: 'opt_estensione_guida', label: 'Estensione guida di 2.35 mt', categoria: 'guida' },
                { id: 'opt_guida_tagliata', label: 'Guida tagliata a misura', categoria: 'guida' },
                { id: 'opt_guida_ribaltabile', label: 'Guida ribaltabile manuale', categoria: 'guida' },
                { id: 'opt_tappeti', label: 'Tappeti', categoria: 'guida' },
                { id: 'opt_guida_ribaltabile_motor', label: 'Guida ribaltabile motorizzata', categoria: 'guida' },
                { id: 'opt_versione_esterni', label: 'Versione per esterni', categoria: 'guida' },
                { id: 'opt_sedile_perch', label: 'Sedile Smart Perch', categoria: 'seduta' },
                { id: 'opt_distanziale_singolo', label: 'Distanziale per bracciolo singolo (+56mm)', categoria: 'seduta' },
                { id: 'opt_distanziale_doppio', label: 'Distanziale entrambi i braccioli (+102mm)', categoria: 'seduta' },
                { id: 'opt_cintura_velcro', label: 'Cintura in Velcro XXL', categoria: 'seduta' },
                { id: 'opt_body_harness', label: 'Body harness', categoria: 'seduta' },
                { id: 'opt_heavy_duty_xl', label: 'Heavy Duty XL', categoria: 'seduta' },
                { id: 'opt_heavy_duty_xxl', label: 'Extra Heavy Duty XXL', categoria: 'seduta' },
                { id: 'opt_rotazione_auto', label: 'Rotazione seggiolino automatica', categoria: 'motorizzate' },
                { id: 'opt_rotazione_2dir', label: 'Rotazione seggiolino automatica 2-direzioni', categoria: 'motorizzate' },
                { id: 'opt_pedana_motor', label: 'Poggiapiedi motorizzato', categoria: 'motorizzate' },
                { id: 'opt_motor_completo', label: 'Motorizzato completo (sedile e pedana)', categoria: 'motorizzate' },
                { id: 'opt_motor_completo_2dir', label: 'Motorizzato completo 2-direzioni', categoria: 'motorizzate' },
                { id: 'opt_one_touch', label: 'One Touch Alert (SIM non inclusa)', categoria: 'motorizzate' },
                { id: 'opt_smontaggio', label: 'Smontaggio e smaltimento impianto preesistente', categoria: 'servizi' }
            ],
            'Facile Superior H4000': [
                { id: 'metri_guida', label: 'Metri guida', categoria: 'input', tipo: 'number', step: '0.1', placeholder: 'Es: 7.5' },
                { id: 'opt_sedile_perch', label: 'Sedile Smart Perch', categoria: 'seduta' },
                { id: 'opt_sedile_esterni', label: 'Sedile SMART (versione esterna)', categoria: 'seduta' },
                { id: 'opt_sedile_style', label: 'Sedile Style', categoria: 'seduta' },
                { id: 'opt_bracciolo_corto', label: 'Bracciolo corto', categoria: 'seduta' },
                { id: 'opt_distanziale_singolo', label: 'Distanziale per bracciolo singolo (+56mm)', categoria: 'seduta' },
                { id: 'opt_distanziale_doppio', label: 'Distanziale entrambi i braccioli (+102mm)', categoria: 'seduta' },
                { id: 'opt_cintura_velcro', label: 'Cintura in Velcro XXL', categoria: 'seduta' },
                { id: 'opt_body_harness', label: 'Body harness', categoria: 'seduta' },
                { id: 'curve_90_qty', label: 'Numero curve aggiuntive a 90°', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'punti_ricarica_qty', label: 'Numero punti di ricarica aggiuntivi', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'metri_esterni', label: 'Metri guida per esterni (supplemento)', categoria: 'input', tipo: 'number', step: '0.1', placeholder: '0' },
                { id: 'fermate_intermedie_qty', label: 'Numero fermate intermedie', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'opt_overrun', label: 'Overrun', categoria: 'guida' },
                { id: 'opt_dropnose', label: 'Dropnose', categoria: 'guida' },
                { id: 'opt_guida_ribaltabile_motor', label: 'Guida ribaltabile motorizzata', categoria: 'guida' },
                { id: 'opt_heavy_duty_160', label: 'Heavy duty kit 160 kg', categoria: 'guida' },
                { id: 'opt_tappeti', label: 'Tappeti', categoria: 'guida' },
                { id: 'opt_colore_speciale', label: 'Colore speciale guida (solo numeri RAL)', categoria: 'guida' },
                { id: 'opt_versione_esterni', label: 'Versione per esterni', categoria: 'guida' },
                { id: 'opt_piastre_muro', label: 'Piastre per attacco a muro', categoria: 'guida' },
                { id: 'opt_conversion_kit', label: 'Conversion Kit', categoria: 'guida' },
                { id: 'opt_rotazione_auto', label: 'Rotazione seggiolino automatica', categoria: 'motorizzate' },
                { id: 'opt_pedana_motor', label: 'Poggiapiedi motorizzato', categoria: 'motorizzate' },
                { id: 'opt_motor_completo', label: 'Motorizzato completo (sedile e pedana)', categoria: 'motorizzate' },
                { id: 'radiocomandi_qty', label: 'Numero radiocomandi aggiuntivi', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'opt_one_touch', label: 'One Touch Alert (SIM non inclusa)', categoria: 'motorizzate' }
            ],
            'Facile Graziosa Freecurve': [
                { id: 'metri_guida', label: 'Metri guida', categoria: 'input', tipo: 'number', step: '0.1', placeholder: 'Es: 7.5' },
                { id: 'curve_90_qty', label: 'Numero curve aggiuntive a 90°', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'punti_ricarica_qty', label: 'Numero punti di ricarica aggiuntivi', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'attacchi_muro_qty', label: 'Numero attacchi a muro aggiuntivi', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'radiocomandi_qty', label: 'Numero radiocomandi aggiuntivi', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'opt_elegance_seat', label: 'Elegance seat', categoria: 'seduta' },
                { id: 'opt_alliance_seat', label: 'Alliance seat', categoria: 'seduta' },
                { id: 'opt_active_seat', label: 'Active seat (solo Elegance/Alliance)', categoria: 'seduta' },
                { id: 'opt_body_harness_4p', label: 'Body harness 4-punti', categoria: 'seduta' },
                { id: 'opt_guida_ribaltabile_motor', label: 'Guida ribaltabile motorizzata', categoria: 'guida' },
                { id: 'opt_colore_speciale', label: 'Colore speciale guida (solo numeri RAL)', categoria: 'guida' },
                { id: 'opt_solo_guida', label: 'Solo guida/supplemento rework', categoria: 'guida' },
                { id: 'opt_rotazione_auto', label: 'Rotazione seggiolino automatica', categoria: 'motorizzate' },
                { id: 'opt_rotazione_2dir', label: 'Rotazione automatica sedile 2-direzioni', categoria: 'motorizzate' },
                { id: 'opt_pedana_illuminato', label: 'Poggiapiedi illuminato e motorizzato', categoria: 'motorizzate' },
                { id: 'opt_batteria_extra', label: 'Batteria Extra Power 12 Ah (oltre 15 metri)', categoria: 'motorizzate' },
                { id: 'opt_batteria_ultra', label: 'Batteria Ultra Power 20 Ah litio (oltre 20 metri)', categoria: 'motorizzate' },
                { id: 'opt_kit_ripetitore', label: 'Kit Ripetitore', categoria: 'motorizzate' }
            ],
            'Infinity Curvilineo Bespoke': [
                { id: 'metri_guida', label: 'Metri guida aggiuntivi (oltre 5m)', categoria: 'input', tipo: 'number', step: '0.1', placeholder: 'Es: 3' },
                { id: 'metri_guida_hd', label: 'Metri guida HD aggiuntivi (oltre 5m)', categoria: 'input', tipo: 'number', step: '0.1', placeholder: '0' },
                { id: 'curve_90_qty', label: 'Numero curve 90° aggiuntive', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'curve_180_qty', label: 'Numero curve 180° aggiuntive', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'curve_speciali_qty', label: 'Numero curve speciali', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'fermate_intermedie_qty', label: 'Numero fermate intermedie', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'punti_ricarica_qty', label: 'Numero punti di ricarica', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'telecomandi_qty', label: 'Numero telecomandi aggiuntivi', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'opt_motor_hd', label: 'Motore HD (girevole manuale)', categoria: 'seduta' },
                { id: 'opt_seduta_regolabile', label: 'Seduta regolabile (estensione 100mm)', categoria: 'seduta' },
                { id: 'opt_sedile_motor', label: 'Sedile girevole motorizzato', categoria: 'motorizzate' },
                { id: 'opt_dual_control', label: 'Dual-Control Kit', categoria: 'motorizzate' },
                { id: 'opt_partenza_drop', label: 'Partenza Drop', categoria: 'guida' },
                { id: 'opt_arrivo_orizzontale', label: 'Arrivo orizzontale', categoria: 'guida' },
                { id: 'opt_fissaggio_muro', label: 'Fissaggio a muro', categoria: 'guida' },
                { id: 'opt_coprigambe', label: 'Coprigambe', categoria: 'seduta' },
                { id: 'opt_colore_nero', label: 'Colore binario nero', categoria: 'guida' },
                { id: 'opt_colore_marrone', label: 'Colore binario marrone', categoria: 'guida' }
            ],
            'Facile Step SRC': [
                { id: 'alzate', label: 'Numero alzate', categoria: 'input', tipo: 'number', placeholder: 'Es: 13' },
                { id: 'metri_guida_extra', label: 'Metri guida aggiuntivi', categoria: 'input', tipo: 'number', step: '0.1', placeholder: 'Es: 2.5' },
                { id: 'colonnini_qty', label: 'Numero colonnini chiamate ai piani', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'fermate_intermedie_qty', label: 'Numero fermate intermedie', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'opt_ped_esterni', label: 'Versione per esterni (guida zincata)', categoria: 'opzioni' },
                { id: 'opt_ped_acustico', label: 'Comando acustico luminoso a bordo', categoria: 'opzioni' }
            ],
            'Facile Step SSC': [
                { id: 'alzate', label: 'Numero alzate', categoria: 'input', tipo: 'number', placeholder: 'Es: 13' },
                { id: 'metri_guida_extra', label: 'Metri guida aggiuntivi', categoria: 'input', tipo: 'number', step: '0.1', placeholder: 'Es: 2.5' },
                { id: 'curve_90_qty', label: 'Numero curve 90°', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'curve_180_qty', label: 'Numero curve 180°', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'colonnini_qty', label: 'Numero colonnini chiamate ai piani', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'fermate_intermedie_qty', label: 'Numero fermate intermedie', categoria: 'input', tipo: 'number', placeholder: '0' },
                { id: 'opt_ped_esterni', label: 'Versione per esterni (guida zincata)', categoria: 'opzioni' },
                { id: 'opt_ped_acustico', label: 'Comando acustico luminoso a bordo', categoria: 'opzioni' },
                { id: 'opt_curve_zincate', label: 'Curve zincate (supplemento)', categoria: 'opzioni' }
            ],
            'Facile Step X3': [
                { id: 'alzate', label: 'Numero alzate', categoria: 'input', tipo: 'number', placeholder: 'Es: 13' },
                { id: 'metri_guida_extra', label: 'Metri guida aggiuntivi', categoria: 'input', tipo: 'number', step: '0.1', placeholder: 'Es: 2.5' },
                { id: 'opt_piattaforma_640', label: 'Piattaforma 640x680', categoria: 'dimensioni' },
                { id: 'opt_piattaforma_800', label: 'Piattaforma 800x800', categoria: 'dimensioni' },
                { id: 'opt_piattaforma_1050', label: 'Piattaforma 800x1050', categoria: 'dimensioni' },
                { id: 'opt_ped_esterni', label: 'Versione per esterni (guida zincata)', categoria: 'opzioni' }
            ],
            'Facile Step ARTIRA': [
                { id: 'alzate', label: 'Numero alzate', categoria: 'input', tipo: 'number', placeholder: 'Es: 13' },
                { id: 'metri_guida_extra', label: 'Metri guida aggiuntivi', categoria: 'input', tipo: 'number', step: '0.1', placeholder: 'Es: 2.5' }
            ]
        };

        // Genera HTML opzioni dinamiche
        function generaOpzioni(modello) {
            const container = document.getElementById('opzioniContainer');
            container.innerHTML = '';

            const opzioni = opzioniPerModello[modello];
            if (!opzioni) return;

            // Raggruppa per categoria
            const categorie = {};
            opzioni.forEach(opt => {
                if (!categorie[opt.categoria]) {
                    categorie[opt.categoria] = [];
                }
                categorie[opt.categoria].push(opt);
            });

            // Titoli categorie
            const titoliCategorie = {
                'input': 'Misure e Quantità',
                'guida': 'Opzioni Guida',
                'seduta': 'Opzioni Seduta',
                'motorizzate': 'Opzioni Motorizzate',
                'servizi': 'Servizi',
                'opzioni': 'Opzioni Aggiuntive',
                'dimensioni': 'Dimensioni Piattaforma'
            };

            // Genera HTML
            Object.keys(categorie).forEach(cat => {
                const divCategoria = document.createElement('div');
                divCategoria.className = 'option-category';
                
                const titolo = document.createElement('h3');
                titolo.className = 'category-title';
                titolo.textContent = titoliCategorie[cat] || cat;
                divCategoria.appendChild(titolo);

                if (cat === 'input') {
                    // Input numerici
                    categorie[cat].forEach(opt => {
                        const wrapper = document.createElement('div');
                        wrapper.className = 'input-wrapper';
                        wrapper.innerHTML = `
                            <label>${opt.label}</label>
                            <input type="${opt.tipo}" name="${opt.id}" step="${opt.step || 1}" min="0" placeholder="${opt.placeholder}" class="calc-trigger">
                            ${opt.hint ? `<p class="input-hint">${opt.hint}</p>` : ''}
                        `;
                        divCategoria.appendChild(wrapper);
                    });
                } else {
                    // Checkbox
                    const checkboxGroup = document.createElement('div');
                    checkboxGroup.className = 'checkbox-group';
                    
                    categorie[cat].forEach(opt => {
                        const checkboxDiv = document.createElement('div');
                        checkboxDiv.className = 'checkbox-option';
                        checkboxDiv.innerHTML = `
                            <input type="checkbox" id="${opt.id}" name="${opt.id}" class="calc-trigger">
                            <label for="${opt.id}">
                                <span class="checkbox-icon"></span>
                                ${opt.label}
                            </label>
                        `;
                        checkboxGroup.appendChild(checkboxDiv);
                    });
                    
                    divCategoria.appendChild(checkboxGroup);
                }

                container.appendChild(divCategoria);
            });

            // Aggiungi listener per ricalcolo
            setTimeout(() => {
                document.querySelectorAll('.calc-trigger').forEach(el => {
                    el.addEventListener('change', calcolaTotale);
                    el.addEventListener('input', calcolaTotale);
                });
                calcolaTotale(); // Calcolo iniziale
            }, 100);
        }

        // Gestione cambio tipo prodotto
        document.querySelectorAll('input[name="tipo"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const modelliPoltroncina = document.getElementById('modelliPoltroncina');
                const modelliPedana = document.getElementById('modelliPedana');

                // Reset modello e opzioni
                document.querySelectorAll('input[name="modello"]').forEach(m => m.checked = false);
                document.getElementById('opzioniContainer').innerHTML = '';

                if (this.value === 'poltroncina') {
                    modelliPoltroncina.classList.remove('hidden');
                    modelliPedana.classList.add('hidden');
                } else {
                    modelliPoltroncina.classList.add('hidden');
                    modelliPedana.classList.remove('hidden');
                }
            });
        });

        // Gestione cambio modello
        document.querySelectorAll('input[name="modello"]').forEach(radio => {
            radio.addEventListener('change', function() {
                generaOpzioni(this.value);
            });
        });

        // Listener campo sconto
        document.getElementById('sconto').addEventListener('input', calcolaTotale);

        // Gestione invio form
        document.getElementById('preventivoForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());

            // Genera numero preventivo
            const numeroPreventivo = `MS-${new Date().getFullYear()}-${Date.now().toString().slice(-6)}`;
            const dataOggi = new Date().toLocaleDateString('it-IT');

            // Prezzi calcolati
            const prezzoListinoText = document.getElementById('prezzoListino').textContent;
            const prezzoFinaleText = document.getElementById('prezzoFinale').textContent;
            const prezzoListinoIvaText = document.getElementById('prezzoListinoIva').textContent;
            const prezzoFinaleIvaText = document.getElementById('prezzoFinaleIva').textContent;
            
            const totaleNetto = parseFloat(prezzoListinoText.replace('€ ', '').replace(/\./g, '').replace(',', '.')) || 0;
            const totaleIvato = parseFloat(prezzoFinaleIvaText.match(/€ ([\d.,]+)/)[1].replace(/\./g, '').replace(',', '.')) || 0;
            const sconto = parseFloat(data.sconto) || 0;

            // Genera PDF (usando window.print)
            const htmlPDF = generaHTMLPreventivo(numeroPreventivo, dataOggi, data, totaleNetto, totaleIvato, sconto);

            // Mostra risultato
            const risultato = document.getElementById('risultato');
            risultato.style.display = 'block';
            risultato.innerHTML = `
                <h2>✓ Preventivo Generato</h2>
                <p style="margin: 20px 0;">Il preventivo è stato creato con successo.</p>
                <p style="font-size: 0.95rem; opacity: 0.9;">
                    <strong>Preventivo n. ${numeroPreventivo}</strong><br>
                    Data: ${dataOggi}<br>
                    Totale IVA inclusa: € ${totaleIvato.toFixed(2)}
                </p>
                <button onclick="stampaPDF()" 
                        style="display: inline-block; 
                               background: white; 
                               color: var(--primary); 
                               padding: 14px 32px; 
                               border: 2px solid white;
                               border-radius: 8px; 
                               font-weight: 600;
                               margin-top: 20px;
                               cursor: pointer;
                               font-family: 'Outfit', sans-serif;
                               font-size: 1rem;">
                    📄 Scarica/Stampa PDF
                </button>
            `;

            // Scroll al risultato
            risultato.scrollIntoView({ behavior: 'smooth', block: 'center' });
        });

        // Funzione genera HTML preventivo
        function generaHTMLPreventivo(numero, data, formData, totaleNetto, totaleIvato, sconto) {
            const totaleDopoSconto = totaleNetto * (1 - sconto / 100);
            const iva = totaleDopoSconto * 0.04;

            return `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial; padding: 40px; }
        .header { text-align: center; margin-bottom: 40px; border-bottom: 4px solid #1a4d2e; padding-bottom: 20px; }
        .header h1 { color: #1a4d2e; margin: 0; }
        .section { margin: 30px 0; padding: 20px; background: #faf8f3; border-radius: 8px; }
        .section h2 { color: #1a4d2e; border-bottom: 2px solid #d4af37; padding-bottom: 8px; }
        .price-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #e5e0d5; }
        .price-row.total { font-size: 1.3rem; font-weight: bold; color: #1a4d2e; border-top: 3px solid #d4af37; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>PREVENTIVO MONTASCALE</h1>
        <p><strong>N° ${numero}</strong> - ${data}</p>
    </div>
    <div class="section">
        <h2>Dati Cliente</h2>
        <p><strong>Nome:</strong> ${formData.cliente_nome}</p>
        ${formData.cliente_email ? `<p><strong>Email:</strong> ${formData.cliente_email}</p>` : ''}
        ${formData.cliente_telefono ? `<p><strong>Telefono:</strong> ${formData.cliente_telefono}</p>` : ''}
        ${formData.indirizzo ? `<p><strong>Indirizzo:</strong> ${formData.indirizzo}</p>` : ''}
    </div>
    <div class="section">
        <h2>Prodotto</h2>
        <p><strong>Tipo:</strong> ${formData.tipo === 'poltroncina' ? 'Montascale a Poltroncina' : 'Montascale a Pedana'}</p>
        <p><strong>Modello:</strong> ${formData.modello}</p>
    </div>
    <div class="section">
        <h2>Riepilogo Economico</h2>
        <div class="price-row"><span>Prezzo di Listino:</span><span>€ ${totaleNetto.toFixed(2)}</span></div>
        ${sconto > 0 ? `<div class="price-row"><span>Sconto (${sconto}%):</span><span>- € ${(totaleNetto * sconto / 100).toFixed(2)}</span></div>` : ''}
        <div class="price-row"><span>IVA (4%):</span><span>€ ${iva.toFixed(2)}</span></div>
        <div class="price-row total"><span>TOTALE:</span><span>€ ${totaleIvato.toFixed(2)}</span></div>
    </div>
    ${formData.note ? `<div class="section"><h2>Note</h2><p>${formData.note}</p></div>` : ''}
</body>
</html>`;
        }

        // Funzione stampa PDF
        function stampaPDF() {
            const formData = new FormData(document.getElementById('preventivoForm'));
            const data = Object.fromEntries(formData.entries());
            const numeroPreventivo = document.querySelector('#risultato strong').textContent.replace('Preventivo n. ', '');
            const dataOggi = new Date().toLocaleDateString('it-IT');
            
            const prezzoListinoText = document.getElementById('prezzoListino').textContent;
            const prezzoFinaleIvaText = document.getElementById('prezzoFinaleIva').textContent;
            const totaleNetto = parseFloat(prezzoListinoText.replace('€ ', '').replace(/\./g, '').replace(',', '.')) || 0;
            const totaleIvato = parseFloat(prezzoFinaleIvaText.match(/€ ([\d.,]+)/)[1].replace(/\./g, '').replace(',', '.')) || 0;
            const sconto = parseFloat(data.sconto) || 0;

            const htmlContent = generaHTMLPreventivo(numeroPreventivo, dataOggi, data, totaleNetto, totaleIvato, sconto);
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(htmlContent);
            printWindow.document.close();
            printWindow.print();
        }
    </script>
</body>
</html>
